% Copyright 2014-2015 by Eicke Godehardt
%
% This file is based on the original themes of LaTeX beamer
% style and may be distributed and/or modified
%
% 1. under the LaTeX Project Public License, version 1.3c
%    or (at your option) any later version and/or
% 2. under the GNU Public License, Version 2 or any later
%    version published by the Free Software Foundation.

\ProvidesPackage{beamerthemeFrankfurtUniversity}

\RequirePackage{listings}
\RequirePackage{graphicx}
\RequirePackage{tikz}


\mode<presentation>

\definecolor{FrankfurtUniversityColor}{RGB}{45,137,204}
\definecolor{FB1Color}{RGB}{124,128,52}
\definecolor{FB2Color}{RGB}{255,158,27}
\definecolor{FB3Color}{RGB}{196,213,42}
\definecolor{FB4Color}{RGB}{204,31,47}

\DeclareOptionBeamer{fb1}{
  \colorlet{FrankfurtUniversityColor}{FB1Color}
}
\DeclareOptionBeamer{fb2}{
  \colorlet{FrankfurtUniversityColor}{FB2Color}
}
\DeclareOptionBeamer{fb3}{
  \colorlet{FrankfurtUniversityColor}{FB3Color}
}
\DeclareOptionBeamer{fb4}{
  \colorlet{FrankfurtUniversityColor}{FB4Color}
}
\ProcessOptionsBeamer


\lstset{%
basicstyle=\ttfamily\scriptsize,        % Code font, Examples: \footnotesize, \ttfamily
keywordstyle=\color{blue!80!black},     % Keywords font ('*' = uppercase)
commentstyle=\color{gray},              % Comments font
numbers=left,                           % Line nums position
numberstyle=\tiny,                      % Line-numbers fonts
stepnumber=1,                           % Step between two line-numbers
numbersep=5pt,                          % How far are line-numbers from code
backgroundcolor=\color{gray!10!white},  % Choose background color
frame=none,                             % A frame around the code
tabsize=2,                              % Default tab size
captionpos=b,                           % Caption-position = bottom
breaklines=true,                        % Automatic line breaking?
breakatwhitespace=false,                % Automatic breaks only at whitespace?
showspaces=false,                       % Dont make spaces visible
showstringspaces=false                  %
showtabs=false,                         % Dont make tabls visible
columns=flexible,                       % Column format
morekeywords={},                        % Specific keywords
stringstyle=\color{green!50!black},%
}%


\usecolortheme{FrankfurtUniversity}


\setbeamerfont{block title}{size={}}

\setbeamertemplate{itemize items}[square]
\setbeamertemplate{sections/subsections in toc}[none]


\newlength{\newheadheight}%
\newlength{\newtextheight}%
\setlength{\newheadheight}{\headheight}%
\setlength{\newtextheight}{\textheight}%
\addtolength{\newheadheight}{.5em}%
\addtolength{\newtextheight}{-.5em}%


\setbeamertemplate{headline}{%
  \ifnum\insertpagenumber=1%
    %{\includegraphics[width=3cm]{haw}\hfill\includegraphics[width=3cm]{FRA-UAS_Logo.pdf}\hspace{2mm}\mbox{}}%
    {\hfill\includegraphics[width=3cm]{/logos/FRA-UAS_Logo.pdf}\hspace{2mm}\mbox{}}%
    \vspace{-4mm}%
  \else%
    {\hfill\includegraphics[width=2.4cm]{/logos/FRA-UAS_Logo.pdf}\hspace{3.3mm}\mbox{}}%
% had to use TeX style of setting this length (actually a skip), for the calc package breaks \setlength
    \global\headheight\newheadheight\relax%
    \global\textheight\newtextheight\relax%
  \fi%
}


\setbeamertemplate{footline}%
{%
  \fontsize{5}{6} \selectfont%
  \ifnum\insertpagenumber=1%
    \begin{beamercolorbox}{titlefooter}%
      \rule[-1.1mm]{0mm}{3.5mm}%
      \hspace*{0.5cm}%
      \insertframenumber/\inserttotalframenumber%
      \hspace*{0.5cm}%
      \insertauthor\ | \inserttitle%
      \hfill%
      \insertdate%
      \hspace*{0.5cm}\mbox{}%
    \end{beamercolorbox}%
  \else%
    \hbox{%
      \begin{beamercolorbox}[wd=.79\paperwidth,ht=.1em,dp=1.2ex,left,leftskip=2ex]{footer}%
        \hspace*{0.4cm}%
        \insertframenumber/\inserttotalframenumber%
        \hspace*{0.5cm}%
        \insertauthor\ | \inserttitle%
      \end{beamercolorbox}%
      \smash{\begin{beamercolorbox}[wd=.20\paperwidth,ht=1.3em,dp=2ex,right,rightskip=2ex]{titlefooter}%
      \end{beamercolorbox}}%
      \hspace{-1.3em}%
      \smash{\begin{beamercolorbox}[wd=2.5em,ht=.18\paperwidth,dp=3ex]{titlefooter}%
      \end{beamercolorbox}%
    }%
  }%
  \fi%
}


\defbeamertemplate*{title page}{customized}[1][]%
{%
  \vspace{2.3ex}%
  \usebeamerfont{subtitle}%
  \usebeamercolor[fg]{subtitle}%
  \hbox{%
    \begin{beamercolorbox}[sep=0.em,wd=1.0\paperwidth,ht=6cm,dp=4cm,leftskip=2.4em]{title}%
      \usebeamerfont{title}{\huge\inserttitle}\par%
      \usebeamerfont{subtitle}{\Large\insertsubtitle}\par%
      \vspace{0.3in}%
      \usebeamerfont{author}\insertauthor\par%
      \usebeamerfont{institute}\insertinstitute\par%
    \end{beamercolorbox}%
    \hspace{1.8mm}%
% insert upright bar on the right
    \begin{beamercolorbox}[sep=1em,wd=1em,ht=4cm,dp=4cm,leftskip=2.em]{titlefooter}%
    \end{beamercolorbox}%
  }%
}

\setbeamertemplate{navigation symbols}{}


\setbeamersize{text margin left=1.5em}
\setbeamersize{text margin right=1.5em}
\setbeamersize{sidebar width right=0.cm}
\setbeamersize{sidebar width left=0cm}


\DeclareRobustCommand{\em}{%
  \color{FrankfurtUniversityColor}\@nomath\em \if b\expandafter\@car\f@series\@nil%
  \normalfont\else\bfseries\fi}
\DeclareTextFontCommand{\emph}{\em}
\DeclareTextFontCommand{\textem}{\em}% depricated 




% The following code to set images transparent after \pause, too.
% https://web.archive.org/web/20140511130153/http://funkysea.com/?p=6
% Content Â© 2014 Funky Sea, under the licence DTFWYW (do the fuck what you want)

%\usepackage{transparent}
\gdef\transparent@value{100}

\let\oldincludegraphics\includegraphics
\renewcommand*{\includegraphics}[2][]{%
    \begin{tikzpicture}%
      {\node[opacity=\transparent@value/100]
      {\oldincludegraphics[#1]{#2}};}%
    \end{tikzpicture}%
}

% override of the original beamer@mixin transparent
\define@key{beamer@mixin}{transparent}[15]{%
    \def\beamer@uncoverbeforeactions{\ignorespaces\opaquenessCustom{#1}}%
    \def\beamer@uncoverafteractions{\ignorespaces\opaquenessCustom{#1}}%
}

% mostly a copy-and-paste of the original code from beamerbaseoverlay.sty
\def\opaquenessCustom#1{%
\only<1->{%
\beamer@actions{%
\gdef\transparent@value{#1}% here we change the custom transparency according to the pauses
\expandafter\xdef\csname beamer@oldcolorhook%
\the\beamer@coveringdepth\endcsname{\beamer@colorhook}%
\expandafter\xdef\csname beamer@oldpgfextension%
\the\beamer@coveringdepth\endcsname{\beamer@pgfextension}%
{\globalcolorstrue\colorlet{beamer@freeze\the\beamer@coveringdepth}{bg}}%
\xdef\beamer@colorhook{!#1!beamer@freeze%
\the\beamer@coveringdepth\beamer@colorhook}%
\gdef\beamer@pgfextension{!#1opaque}%
\color{.}%
}%
{%
\gdef\transparent@value{100}% here we initialize our custom transparency
\xdef\beamer@colorhook{\csname beamer@oldcolorhook%
\the\beamer@coveringdepth\endcsname}%
\xdef\beamer@pgfextension{\csname beamer@oldpgfextension%
\the\beamer@coveringdepth\endcsname}%
\color{.}%
}}%
}%

\setbeamercovered{transparent}


\mode
<all>
